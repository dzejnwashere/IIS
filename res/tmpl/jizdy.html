<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Line management</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th, td {
            text-align: left;
            padding: 8px;
        }

        tr:nth-child(even){background-color: #f2f2f2}

        th {
            background-color: #D22B2B;
            color: white;
        }

        tr.selected {
            background-color: #f2d2d2
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
{{$A := .}}
<h2>Drive management üöé</h2><br>
<label for="selectedDate">Select date:</label> <input type="date" id="selectedDate" onchange="GetDnyJizdy();FillSpojeDne()"><label for="dayCategory">Dny jizdy:</label> <select id="dayCategory" onchange="SetDnyJizdy()">
    <option value="dj-1">-- Select --</option>
    {{range .DnyJizdy}}
    <option value="dj{{.Id}}">{{.Popis}}</option>
    {{end}}
</select>
<table><tr><th>
<table id="spoje_dne"><thead><tr><th>Linka</th><th>Poƒç√°teƒçn√≠ zast√°vka</th><th>V√Ωjezd</th><th>C√≠lov√° zast√°vka</th><th>P≈ô√≠jezd</th><th>≈òidiƒç</th><th>V≈Øz</th></tr></thead>
<tbody></tbody>
</table> </td><td><table><tr><td>
<table id="dostupni_ridici"><thead><tr><th>Jm√©no</th><th>P≈ô√≠jmen√≠</th><th>Posledn√≠ j√≠zda</th><th>N√°sleduj√≠c√≠ j√≠zda</th></tr></thead>
</table></td></tr><tr><td>
<table id="dostupne_vozy"><thead><tr><th>Jm√©no</th><th>P≈ô√≠jmen√≠</th><th>Posledn√≠ j√≠zda</th><th>N√°sleduj√≠c√≠ j√≠zda</th></tr></thead>

</table></td></tr></table> </td></tr></table>
<script>
    function GetDnyJizdy() {
        $.ajax({
            url: "/kategorie_dne/" + $("#selectedDate").val(),
            type: "GET",
            success: function (response) {
                $("#dayCategory").val("dj"+response)
            }
        })
    }
    function FillSpojeDne() {
        $.ajax({
            url: "/jizdy/" + $("#selectedDate").val(),
            type: "GET",
            success: function (response) {
                var ar = response.split("\n")
                $("#spoje_dne tbody").empty()
                for (var i = 0; i < ar.length - 1; i++) {
                    var a = ar[i].split(";")
                    $("#spoje_dne tbody").append("<tr id='jizda-" + a[0] + "'><td>"+a[1]+"</td><td>"+a[2]+"</td><td>"+a[3]+"</td><td>"+a[4]+"</td><td>"+a[5]+"</td><td>"+a[6]+"</td><td>"+a[7]+"</td></tr>")
                }
            }
        })
    }
    function SetDnyJizdy() {
        $.ajax({
            url: "/kategorie_dne/" + $("#selectedDate").val(),
            type: "POST",
            data: {den_jizdy: $("#dayCategory").val().substring(2)},
            error: function (response) {
                alert("Error changing the drive day cateory")
            }
        })
    }
</script>
</body>
</html>